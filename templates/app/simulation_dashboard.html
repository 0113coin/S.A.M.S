{% extends 'base.html' %}
{% block title %}SAMS ì‹œë®¬ë ˆì´ì…˜ ëŒ€ì‹œë³´ë“œ{% endblock %}
{% block head_extra %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
.simulation-controls {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 1rem;
    padding: 1.5rem;
    color: white;
    margin-bottom: 1.5rem;
}

.speed-controls {
    display: flex;
    gap: 0.5rem;
    margin-top: 1rem;
}

.speed-btn {
    padding: 0.5rem 1rem;
    border: 2px solid rgba(255,255,255,0.3);
    border-radius: 0.5rem;
    background: rgba(255,255,255,0.1);
    color: white;
    cursor: pointer;
    transition: all 0.2s;
}

.speed-btn:hover, .speed-btn.active {
    background: rgba(255,255,255,0.2);
    border-color: rgba(255,255,255,0.5);
}

.event-feed {
    max-height: 400px;
    overflow-y: auto;
}

.event-item {
    border-left: 4px solid #3b82f6;
    padding: 1rem;
    margin-bottom: 1rem;
    background: white;
    border-radius: 0.5rem;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.event-positive { border-left-color: #10b981; }
.event-negative { border-left-color: #ef4444; }
.event-neutral { border-left-color: #6b7280; }

/* ì„¹í„°ë³„ í•„í„° ë²„íŠ¼ */
.sector-filter-btn {
    transition: all 0.2s;
    border: 1px solid transparent;
}

.sector-filter-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.sector-filter-btn.active {
    border-color: #3b82f6;
    box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
}

/* ì„¹í„° ê·¸ë£¹ */
.sector-group {
    border: 1px solid #e5e7eb;
    border-radius: 0.75rem;
    padding: 1.5rem;
    background: #fafafa;
    transition: all 0.2s;
}

.sector-group:hover {
    border-color: #d1d5db;
    background: #f9fafb;
}

.sector-group h4 {
    margin: 0;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

/* ì£¼ì‹ ì¹´ë“œ */
.stock-card {
    background: white;
    padding: 1rem;
    border-radius: 0.5rem;
    border: 1px solid #e5e7eb;
    transition: all 0.2s;
    cursor: pointer;
}

.stock-card:hover {
    border-color: #3b82f6;
    box-shadow: 0 2px 8px rgba(59, 130, 246, 0.1);
    transform: translateY(-1px);
}

.stock-card.up {
    border-left: 4px solid #10b981;
    background: linear-gradient(135deg, #f0fdf4 0%, #ffffff 100%);
}

.stock-card.down {
    border-left: 4px solid #ef4444;
    background: linear-gradient(135deg, #fef2f2 0%, #ffffff 100%);
}

.stock-card.neutral {
    border-left: 4px solid #6b7280;
}

/* ì„¹í„° ì ‘ê¸°/í¼ì¹˜ê¸° */
.sector-content {
    transition: all 0.3s ease;
}

.sector-content.hidden {
    max-height: 0;
    overflow: hidden;
    opacity: 0;
}

.sector-content:not(.hidden) {
    max-height: 500px;
    opacity: 1;
}

/* ì„¹í„° í—¤ë” í´ë¦­ ê°€ëŠ¥ í‘œì‹œ */
.sector-group .cursor-pointer {
    transition: all 0.2s;
}

.sector-group .cursor-pointer:hover {
    background: rgba(59, 130, 246, 0.05);
    border-radius: 0.5rem;
    padding: 0.5rem;
    margin: -0.5rem;
}

/* ì´ë²¤íŠ¸ í”¼ë“œ ê°œì„  */
.event-feed {
    max-height: 400px;
    overflow-y: auto;
    padding-right: 0.5rem;
}

.event-feed::-webkit-scrollbar {
    width: 6px;
}

.event-feed::-webkit-scrollbar-track {
    background: #f1f5f9;
    border-radius: 3px;
}

.event-feed::-webkit-scrollbar-thumb {
    background: #cbd5e1;
    border-radius: 3px;
}

.event-feed::-webkit-scrollbar-thumb:hover {
    background: #94a3b8;
}

/* ì‹œë®¬ë ˆì´ì…˜ í†µê³„ ì¹´ë“œ */
.stat-card {
    background: white;
    padding: 1.5rem;
    border-radius: 1rem;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    text-align: center;
    border-left: 4px solid #3b82f6;
    transition: all 0.2s;
}

.stat-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 15px rgba(0,0,0,0.1);
}

.stat-value {
    font-size: 2rem;
    font-weight: bold;
    margin-bottom: 0.5rem;
}

.stat-label {
    color: #6b7280;
    font-size: 0.875rem;
}

/* ë°˜ì‘í˜• ê·¸ë¦¬ë“œ */
@media (max-width: 768px) {
    .sector-group {
        padding: 1rem;
    }
    
    .stock-card {
        padding: 0.75rem;
    }
    
    .sector-filter-btn {
        padding: 0.5rem 1rem;
        font-size: 0.875rem;
    }
}
</style>
{% endblock %}

{% block body %}
<div class="grid grid-cols-12 min-h-screen">
  <aside class="col-span-2 bg-white border-r">
    <div class="p-4 font-bold">SAMS</div>
    <nav class="px-2 space-y-1">
      <a href="{% url 'home' %}" class="block px-3 py-2 hover:bg-slate-50 rounded-lg">í™ˆ</a>
      <a href="{% url 'portfolio' %}" class="block px-3 py-2 bg-slate-100 rounded-lg">í¬íŠ¸í´ë¦¬ì˜¤</a>
      <a href="{% url 'trading' %}" class="block px-3 py-2 hover:bg-slate-50 rounded-lg">ê±°ë˜</a>
      <a href="{% url 'news' %}" class="block px-3 py-2 hover:bg-slate-50 rounded-lg">ë‰´ìŠ¤</a>
      <a href="{% url 'admin' %}" class="block px-3 py-2 hover:bg-slate-50 rounded-lg">ê´€ë¦¬ì</a>
    </nav>
  </aside>

  <main class="col-span-10 bg-slate-50 p-4 space-y-6">
    <!-- ì‹œë®¬ë ˆì´ì…˜ ìƒíƒœ í‘œì‹œ -->
    <div class="simulation-controls">
      <div class="flex items-center justify-between">
        <div>
          <h1 class="text-2xl font-bold">AI ì‹œì¥ ì‹œë®¬ë ˆì´ì…˜</h1>
          <p class="text-blue-100 mt-1">AIê°€ ë§Œë“œëŠ” ê°€ìƒ ê²½ì œ í™˜ê²½ì—ì„œ íˆ¬ì ì „ëµì„ ì—°ìŠµí•˜ì„¸ìš”</p>
        </div>
        <div class="text-right">
          <div class="simulation-time" id="simulationTime">
            ì‹œë®¬ë ˆì´ì…˜ ì‹œê°„: 2025-08-20 14:24
          </div>
          <div class="text-sm text-blue-200 mt-1">
            <a href="{% url 'admin' %}" class="underline">ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œì—ì„œ ì œì–´</a>
          </div>
        </div>
      </div>
      
      <div class="flex items-center gap-4 mt-4">
        <div class="px-6 py-2 bg-gray-500 rounded-lg font-semibold text-white">
          ê´€ë¦¬ì ì „ìš© ì œì–´
        </div>
        <div class="text-sm text-blue-200">
          ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘/ì •ì§€ëŠ” ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œì—ì„œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.
        </div>
      </div>
    </div>

    <!-- ì£¼ê°€ ê·¸ë¦¬ë“œ -->
    <div class="bg-white rounded-2xl shadow-soft overflow-hidden">
      <div class="p-4 border-b">
        <h3 class="text-lg font-semibold">ì£¼ê°€ ëª¨ë‹ˆí„°ë§</h3>
        <p class="text-sm text-slate-600 mt-1">ì„¹í„°ë³„ë¡œ ê·¸ë£¹í™”ëœ ì£¼ìš” ì¢…ëª©ë“¤ì˜ ì‹¤ì‹œê°„ ê°€ê²©</p>
      </div>
      
      <div class="p-4">
        <!-- ì„¹í„°ë³„ í•„í„° -->
        <div class="flex flex-wrap gap-2 mb-4">
          <button class="sector-filter-btn px-3 py-2 rounded-lg bg-blue-100 text-blue-800 text-sm font-medium active" data-sector="all">
            ì „ì²´ ë³´ê¸°
          </button>
          <button class="sector-filter-btn px-3 py-2 rounded-lg bg-gray-100 text-gray-800 text-sm font-medium" data-sector="ë°˜ë„ì²´">
            ë°˜ë„ì²´ (3)
          </button>
          <button class="sector-filter-btn px-3 py-2 rounded-lg bg-gray-100 text-gray-800 text-sm font-medium" data-sector="ìë™ì°¨">
            ìë™ì°¨ (2)
          </button>
          <button class="sector-filter-btn px-3 py-2 rounded-lg bg-gray-100 text-gray-800 text-sm font-medium" data-sector="í™”í•™">
            í™”í•™ (3)
          </button>
          <button class="sector-filter-btn px-3 py-2 rounded-lg bg-gray-100 text-gray-800 text-sm font-medium" data-sector="ê¸ˆìœµ">
            ê¸ˆìœµ (5)
          </button>
          <button class="sector-filter-btn px-3 py-2 rounded-lg bg-gray-100 text-gray-800 text-sm font-medium" data-sector="ê±´ì„¤">
            ê±´ì„¤ (3)
          </button>
          <button class="sector-filter-btn px-3 py-2 rounded-lg bg-gray-100 text-gray-800 text-sm font-medium" data-sector="í†µì‹ ">
            í†µì‹  (2)
          </button>
          <button class="sector-filter-btn px-3 py-2 rounded-lg bg-gray-100 text-gray-800 text-sm font-medium" data-sector="ë°”ì´ì˜¤">
            ë°”ì´ì˜¤ (2)
          </button>
          <button class="sector-filter-btn px-3 py-2 rounded-lg bg-gray-100 text-gray-800 text-sm font-medium" data-sector="ì¸í„°ë„·">
            ì¸í„°ë„· (2)
          </button>
          <button class="sector-filter-btn px-3 py-2 rounded-lg bg-gray-100 text-gray-800 text-sm font-medium" data-sector="ì‹í’ˆ">
            ì‹í’ˆ (1)
          </button>
        </div>
        
        <!-- ì„¹í„°ë³„ ì£¼ì‹ ê·¸ë£¹ -->
        <div id="stockSectors">
          <!-- ë°˜ë„ì²´ ì„¹í„° -->
          <div class="sector-group mb-6" data-sector="ë°˜ë„ì²´">
            <div class="flex items-center justify-between mb-3">
              <h4 class="font-semibold text-lg text-blue-800">ğŸ”µ ë°˜ë„ì²´</h4>
              <span class="text-sm text-slate-500">3ê°œ ì¢…ëª©</span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
              <div class="stock-card" data-ticker="005930">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">ì‚¼ì„±ì „ì</div>
                    <div class="text-sm text-slate-500">005930</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©79,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
              <div class="stock-card" data-ticker="000660">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">SKí•˜ì´ë‹‰ìŠ¤</div>
                    <div class="text-sm text-slate-500">000660</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©45,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
              <div class="stock-card" data-ticker="011070">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">LGì´ë…¸í…</div>
                    <div class="text-sm text-slate-500">011070</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©180,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ìë™ì°¨ ì„¹í„° -->
          <div class="sector-group mb-6" data-sector="ìë™ì°¨">
            <div class="flex items-center justify-between mb-3">
              <h4 class="font-semibold text-lg text-green-800">ğŸŸ¢ ìë™ì°¨</h4>
              <span class="text-sm text-slate-500">2ê°œ ì¢…ëª©</span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
              <div class="stock-card" data-ticker="005380">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">í˜„ëŒ€ì°¨</div>
                    <div class="text-sm text-slate-500">005380</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©180,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
              <div class="stock-card" data-ticker="005490">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">ê¸°ì•„</div>
                    <div class="text-sm text-slate-500">005490</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©85,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- í™”í•™ ì„¹í„° -->
          <div class="sector-group mb-6" data-sector="í™”í•™">
            <div class="flex items-center justify-between mb-3">
              <h4 class="font-semibold text-lg text-purple-800">ğŸŸ£ í™”í•™</h4>
              <span class="text-sm text-slate-500">3ê°œ ì¢…ëª©</span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
              <div class="stock-card" data-ticker="051910">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">LGí™”í•™</div>
                    <div class="text-sm text-slate-500">051910</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©520,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
              <div class="stock-card" data-ticker="006400">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">ì‚¼ì„±SDI</div>
                    <div class="text-sm text-slate-500">006400</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©380,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
              <div class="stock-card" data-ticker="373220">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">LGì—ë„ˆì§€ì†”ë£¨ì…˜</div>
                    <div class="text-sm text-slate-500">373220</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©450,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ê¸ˆìœµ ì„¹í„° -->
          <div class="sector-group mb-6" data-sector="ê¸ˆìœµ">
            <div class="flex items-center justify-between mb-3">
              <h4 class="font-semibold text-lg text-yellow-800">ğŸŸ¡ ê¸ˆìœµ</h4>
              <span class="text-sm text-slate-500">5ê°œ ì¢…ëª©</span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-5 gap-3">
              <div class="stock-card" data-ticker="055550">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">ì‹ í•œì§€ì£¼</div>
                    <div class="text-sm text-slate-500">055550</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©45,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
              <div class="stock-card" data-ticker="086790">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">í•˜ë‚˜ê¸ˆìœµì§€ì£¼</div>
                    <div class="text-sm text-slate-500">086790</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©42,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
              <div class="stock-card" data-ticker="105560">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">KBê¸ˆìœµ</div>
                    <div class="text-sm text-slate-500">105560</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©65,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
              <div class="stock-card" data-ticker="138930">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">BNKê¸ˆìœµì§€ì£¼</div>
                    <div class="text-sm text-slate-500">138930</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©8,500</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
              <div class="stock-card" data-ticker="323410">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">ì¹´ì¹´ì˜¤ë±…í¬</div>
                    <div class="text-sm text-slate-500">323410</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©28,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ì¸í„°ë„· ì„¹í„° -->
          <div class="sector-group mb-6" data-sector="ì¸í„°ë„·">
            <div class="flex items-center justify-between mb-3">
              <h4 class="font-semibold text-lg text-red-800">ğŸ”´ ì¸í„°ë„·</h4>
              <span class="text-sm text-slate-500">2ê°œ ì¢…ëª©</span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
              <div class="stock-card" data-ticker="035420">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">NAVER</div>
                    <div class="text-sm text-slate-500">035420</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©220,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
              <div class="stock-card" data-ticker="035720">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">ì¹´ì¹´ì˜¤</div>
                    <div class="text-sm text-slate-500">035720</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©45,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ì‹í’ˆ/ì†Œë¹„ì¬ ì„¹í„° -->
          <div class="sector-group mb-6" data-sector="ì‹í’ˆ">
            <div class="flex items-center justify-between mb-3">
              <h4 class="font-semibold text-lg text-yellow-800">ğŸŸ¡ ì‹í’ˆ/ì†Œë¹„ì¬</h4>
              <span class="text-sm text-slate-500">1ê°œ ì¢…ëª©</span>
            </div>
            <div class="grid grid-cols-1 gap-3">
              <div class="stock-card" data-ticker="097950">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">CJì œì¼ì œë‹¹</div>
                    <div class="text-sm text-slate-500">097950</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©380,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ê±´ì„¤/ì¡°ì„  ì„¹í„° -->
          <div class="sector-group mb-6" data-sector="ê±´ì„¤">
            <div class="flex items-center justify-between mb-3">
              <h4 class="font-semibold text-lg text-orange-800">ğŸŸ  ê±´ì„¤/ì¡°ì„ </h4>
              <span class="text-sm text-slate-500">3ê°œ ì¢…ëª©</span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
              <div class="stock-card" data-ticker="028260">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">ì‚¼ì„±ë¬¼ì‚°</div>
                    <div class="text-sm text-slate-500">028260</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©45,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
              <div class="stock-card" data-ticker="009540">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">í˜„ëŒ€ì¤‘ê³µì—…</div>
                    <div class="text-sm text-slate-500">009540</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©120,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
              <div class="stock-card" data-ticker="010140">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">ì‚¼ì„±ì¤‘ê³µì—…</div>
                    <div class="text-sm text-slate-500">010140</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©8,500</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- í†µì‹  ì„¹í„° -->
          <div class="sector-group mb-6" data-sector="í†µì‹ ">
            <div class="flex items-center justify-between mb-3">
              <h4 class="font-semibold text-lg text-indigo-800">ğŸ”· í†µì‹ </h4>
              <span class="text-sm text-slate-500">2ê°œ ì¢…ëª©</span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
              <div class="stock-card" data-ticker="017670">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">SKí…”ë ˆì½¤</div>
                    <div class="text-sm text-slate-500">017670</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©45,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
              <div class="stock-card" data-ticker="030200">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">KT</div>
                    <div class="text-sm text-slate-500">030200</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©32,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ë°”ì´ì˜¤ ì„¹í„° -->
          <div class="sector-group mb-6" data-sector="ë°”ì´ì˜¤">
            <div class="flex items-center justify-between mb-3">
              <h4 class="font-semibold text-lg text-pink-800">ğŸŒ¸ ë°”ì´ì˜¤</h4>
              <span class="text-sm text-slate-500">2ê°œ ì¢…ëª©</span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
              <div class="stock-card" data-ticker="068270">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">ì…€íŠ¸ë¦¬ì˜¨</div>
                    <div class="text-sm text-slate-500">068270</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©180,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
              <div class="stock-card" data-ticker="207940">
                <div class="flex justify-between items-center">
                  <div>
                    <div class="font-semibold">ì‚¼ì„±ë°”ì´ì˜¤ë¡œì§ìŠ¤</div>
                    <div class="text-sm text-slate-500">207940</div>
                  </div>
                  <div class="text-right">
                    <div class="font-bold text-lg">â‚©850,000</div>
                    <div class="text-sm text-green-600">+0.00%</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ì°¨íŠ¸ì™€ ì´ë²¤íŠ¸ -->
    <div class="grid lg:grid-cols-3 gap-4">
      <div class="lg:col-span-2 bg-white p-4 rounded-2xl shadow-soft">
        <div class="flex justify-between items-center mb-4">
          <span class="font-semibold">ì£¼ê°€ ë³€í™” ì°¨íŠ¸</span>
          <select id="chartStock" class="border rounded-lg px-3 py-1">
            <option value="005930">ì‚¼ì„±ì „ì</option>
            <option value="000660">SKí•˜ì´ë‹‰ìŠ¤</option>
            <option value="005380">í˜„ëŒ€ì°¨</option>
            <option value="005490">ê¸°ì•„</option>
            <option value="035420">NAVER</option>
            <option value="051910">LGí™”í•™</option>
            <option value="006400">ì‚¼ì„±SDI</option>
            <option value="012450">í•œí™”ì—ì–´ë¡œìŠ¤í˜ì´ìŠ¤</option>
            <option value="055550">ì‹ í•œì§€ì£¼</option>
            <option value="086790">í•˜ë‚˜ê¸ˆìœµì§€ì£¼</option>
            <option value="105560">KBê¸ˆìœµ</option>
            <option value="138930">BNKê¸ˆìœµì§€ì£¼</option>
            <option value="028260">ì‚¼ì„±ë¬¼ì‚°</option>
            <option value="009540">í˜„ëŒ€ì¤‘ê³µì—…</option>
            <option value="010140">ì‚¼ì„±ì¤‘ê³µì—…</option>
            <option value="017670">SKí…”ë ˆì½¤</option>
            <option value="030200">KT</option>
            <option value="011070">LGì´ë…¸í…</option>
            <option value="015760">í•œêµ­ì „ë ¥</option>
            <option value="096770">SKì´ë…¸ë² ì´ì…˜</option>
            <option value="068270">ì…€íŠ¸ë¦¬ì˜¨</option>
            <option value="207940">ì‚¼ì„±ë°”ì´ì˜¤ë¡œì§ìŠ¤</option>
            <option value="097950">CJì œì¼ì œë‹¹</option>
            <option value="035720">ì¹´ì¹´ì˜¤</option>
            <option value="323410">ì¹´ì¹´ì˜¤ë±…í¬</option>
            <option value="373220">LGì—ë„ˆì§€ì†”ë£¨ì…˜</option>
          </select>
        </div>
        <canvas id="priceChart" class="mt-3 h-64 w-full"></canvas>
      </div>
      
      <div class="bg-white p-4 rounded-2xl shadow-soft">
        <div class="font-semibold mb-4">ì‹¤ì‹œê°„ ì´ë²¤íŠ¸</div>
        <div class="event-feed" id="eventFeed">
          <div class="text-center text-slate-500 py-8">
            ì‹œë®¬ë ˆì´ì…˜ì„ ì‹œì‘í•˜ë©´ AI ì´ë²¤íŠ¸ê°€ ìƒì„±ë©ë‹ˆë‹¤
          </div>
        </div>
      </div>
    </div>

    <!-- ì‹œë®¬ë ˆì´ì…˜ í†µê³„ -->
    <div class="grid md:grid-cols-4 gap-4">
      <div class="stat-card">
        <div class="stat-value text-blue-600" id="totalEvents">0</div>
        <div class="stat-label">ë°œìƒí•œ ì´ë²¤íŠ¸</div>
      </div>
      <div class="stat-card">
        <div class="stat-value text-green-600" id="simulationHours">0</div>
        <div class="stat-label">ì‹œë®¬ë ˆì´ì…˜ ì‹œê°„</div>
      </div>
      <div class="stat-card">
        <div class="stat-value text-purple-600" id="marketVolatility">0%</div>
        <div class="stat-label">ì‹œì¥ ë³€ë™ì„±</div>
      </div>
      <div class="stat-card">
        <div class="stat-value text-orange-600" id="aiActivity">0</div>
        <div class="stat-label">AI í™œë™ë„</div>
      </div>
    </div>
  </main>
</div>
{% endblock %}

{% block scripts %}
<script>
// ì‹œë®¬ë ˆì´ì…˜ ìƒíƒœ
let simulationState = 'stopped';
let simulationSpeed = 2;
let simulationStartTime = null;
let priceHistory = {};
let eventCount = 0;
let currentSimulationId = 'default-sim';

// íŒŒì´ì–´ë² ì´ìŠ¤ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
async function fetchSimulationData() {
    try {
        // ì‹œë®¬ë ˆì´ì…˜ ìƒíƒœ ì¡°íšŒ
        const statusResponse = await fetch(`/api/simulation/status/?simulation_id=${currentSimulationId}`);
        const statusData = await statusResponse.json();
        
        if (statusData.success && statusData.data.status === 'active') {
            // ìµœê·¼ ì´ë²¤íŠ¸ ì¡°íšŒ
            const eventsResponse = await fetch(`/api/simulation/events/?simulation_id=${currentSimulationId}&limit=10`);
            const eventsData = await eventsResponse.json();
            
            if (eventsData.success) {
                updateEventFeed(eventsData.data.events);
                eventCount = eventsData.data.total_count;
                document.getElementById('totalEvents').textContent = eventCount;
            }
            
            // ì‹œì¥ ìš”ì•½ ì •ë³´ ì¡°íšŒ
            const marketResponse = await fetch(`/api/simulation/market-summary/?simulation_id=${currentSimulationId}`);
            const marketData = await marketResponse.json();
            
            if (marketData.success) {
                updateMarketStats(marketData.data);
            }
        }
    } catch (error) {
        console.error('ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„° ì¡°íšŒ ì‹¤íŒ¨:', error);
    }
}

// ì´ë²¤íŠ¸ í”¼ë“œ ì—…ë°ì´íŠ¸
function updateEventFeed(events) {
    const feed = document.getElementById('eventFeed');
    feed.innerHTML = '';
    
    if (events.length === 0) {
        feed.innerHTML = '<div class="text-center text-slate-500 py-8">ì‹œë®¬ë ˆì´ì…˜ì„ ì‹œì‘í•˜ë©´ AI ì´ë²¤íŠ¸ê°€ ìƒì„±ë©ë‹ˆë‹¤</div>';
        return;
    }
    
    events.forEach(event => {
        const eventDiv = document.createElement('div');
        
        const sentimentClass = event.sentiment > 0 ? 'event-positive' : 
                              event.sentiment < 0 ? 'event-negative' : 'event-neutral';
        
        const sentimentText = event.sentiment > 0 ? 'ê¸ì •' : 
                             event.sentiment < 0 ? 'ë¶€ì •' : 'ì¤‘ë¦½';
        
        eventDiv.className = `event-item ${sentimentClass}`;
        eventDiv.innerHTML = `
            <div class="flex justify-between items-start">
                <div>
                    <div class="font-medium">${event.event_type}</div>
                    <div class="text-sm text-slate-600 mt-1">${event.category} | ${sentimentText}</div>
                </div>
                <div class="text-xs text-slate-500">${formatTime(event.created_at)}</div>
            </div>
            <div class="text-sm text-slate-700 mt-2">ì˜í–¥ë„: ${event.impact_level}/5 | ì‹œì¥ ì˜í–¥: ${(event.market_impact * 100).toFixed(1)}%</div>
            <div class="flex gap-2 mt-2">
                <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">ì˜í–¥ë„: ${event.impact_level}</span>
                <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">${event.affected_stocks.join(', ')}</span>
            </div>
        `;
        
        feed.appendChild(eventDiv);
    });
}

// ì‹œì¥ í†µê³„ ì—…ë°ì´íŠ¸
function updateMarketStats(marketData) {
    if (marketData.average_sentiment !== undefined) {
        const sentimentElement = document.getElementById('marketSentiment');
        if (sentimentElement) {
            const sentimentText = marketData.average_sentiment > 0 ? 'ê¸ì •' : 
                                 marketData.average_sentiment < 0 ? 'ë¶€ì •' : 'ì¤‘ë¦½';
            sentimentElement.textContent = sentimentText;
        }
    }
    
    if (marketData.market_volatility !== undefined) {
        document.getElementById('marketVolatility').textContent = 
            (marketData.market_volatility * 100).toFixed(1) + '%';
    }
    
    if (marketData.total_events !== undefined) {
        document.getElementById('totalEvents').textContent = marketData.total_events;
    }
}

// ì‹œê°„ í¬ë§·íŒ…
function formatTime(timestamp) {
    if (!timestamp) return '';
    const date = new Date(timestamp);
    return date.toLocaleTimeString('ko-KR', { 
        hour: '2-digit', 
        minute: '2-digit',
        second: '2-digit'
    });
}

// ë‰´ìŠ¤ í”¼ë“œ ì¡°íšŒ
async function fetchNewsFeed() {
    try {
        const response = await fetch(`/api/simulation/news/?simulation_id=${currentSimulationId}&limit=5`);
        const data = await response.json();
        
        if (data.success) {
            updateNewsFeed(data.data.news_feed);
        }
    } catch (error) {
        console.error('ë‰´ìŠ¤ í”¼ë“œ ì¡°íšŒ ì‹¤íŒ¨:', error);
    }
}

// ë‰´ìŠ¤ í”¼ë“œ ì—…ë°ì´íŠ¸
function updateNewsFeed(newsFeed) {
    // ë‰´ìŠ¤ í”¼ë“œê°€ ìˆë‹¤ë©´ í‘œì‹œ (í•„ìš”ì‹œ êµ¬í˜„)
    console.log('ë‰´ìŠ¤ í”¼ë“œ:', newsFeed);
}

// ì°¨íŠ¸ ì´ˆê¸°í™”
const ctx = document.getElementById('priceChart');
const priceChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: [],
        datasets: [{
            label: 'ì£¼ê°€',
            data: [],
            borderColor: '#3b82f6',
            backgroundColor: 'rgba(59, 130, 246, 0.1)',
            tension: 0.4
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: { display: false }
        },
        scales: {
            y: {
                beginAtZero: false,
                ticks: {
                    callback: function(value) {
                        return 'â‚©' + value.toLocaleString();
                    }
                }
            }
        }
    }
});

// ì„¹í„°ë³„ í•„í„°ë§
function filterBySector(sector) {
    const sectorGroups = document.querySelectorAll('.sector-group');
    
    sectorGroups.forEach(group => {
        if (sector === 'all' || group.dataset.sector === sector) {
            group.style.display = 'block';
        } else {
            group.style.display = 'none';
        }
    });
    
    // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
    document.querySelectorAll('.sector-filter-btn').forEach(btn => {
        btn.classList.remove('active');
        btn.className = btn.className.replace('bg-blue-100 text-blue-800', 'bg-gray-100 text-gray-800');
    });
    
    event.target.classList.add('active');
    event.target.className = event.target.className.replace('bg-gray-100 text-gray-800', 'bg-blue-100 text-blue-800');
}



// ì‹œë®¬ë ˆì´ì…˜ ìƒíƒœëŠ” ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œì—ì„œë§Œ ì œì–´ ê°€ëŠ¥
function showAdminControlMessage() {
    alert('ì‹œë®¬ë ˆì´ì…˜ ì œì–´ëŠ” ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œì—ì„œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
}

// ì‹œë®¬ë ˆì´ì…˜ ì‹œê°„ ì—…ë°ì´íŠ¸
function updateSimulationTime() {
    if (simulationStartTime && simulationState === 'running') {
        const elapsed = Date.now() - simulationStartTime;
        const hours = Math.floor(elapsed / (1000 * 60 * 60 * simulationSpeed));
        const minutes = Math.floor((elapsed % (1000 * 60 * 60 * simulationSpeed)) / (1000 * 60 * simulationSpeed));
        
        document.getElementById('simulationTime').textContent = 
            `ì‹œë®¬ë ˆì´ì…˜ ì‹œê°„: +${hours}ì‹œê°„ ${minutes}ë¶„`;
        document.getElementById('simulationHours').textContent = hours;
    }
}

// ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (ê´€ë¦¬ì ì œì–´ ì•ˆë‚´)
document.addEventListener('click', function(e) {
    if (e.target.closest('.simulation-controls .control-btn')) {
        showAdminControlMessage();
    }
});

// ì„¹í„° í•„í„°ë§
document.querySelectorAll('.sector-filter-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
        const sector = e.target.dataset.sector;
        filterBySector(sector);
    });
});

// ì°¨íŠ¸ ì¢…ëª© ë³€ê²½
document.getElementById('chartStock').addEventListener('change', updateChart);

// ì°¨íŠ¸ ì—…ë°ì´íŠ¸ (ê¸°ë³¸ êµ¬í˜„)
function updateChart() {
    // ì°¨íŠ¸ ì—…ë°ì´íŠ¸ ë¡œì§ (í•„ìš”ì‹œ êµ¬í˜„)
}

// ì´ˆê¸° ë°ì´í„° ë¡œë“œ
document.addEventListener('DOMContentLoaded', function() {
    fetchSimulationData();
    fetchNewsFeed();
    
    // ì£¼ê¸°ì ìœ¼ë¡œ ë°ì´í„° ìƒˆë¡œê³ ì¹¨ (ì‹œë®¬ë ˆì´ì…˜ ì¤‘ì´ ì•„ë‹ ë•Œ)
    setInterval(() => {
        if (simulationState !== 'running') {
            fetchSimulationData();
        }
    }, 30000); // 30ì´ˆë§ˆë‹¤
});
</script>
{% endblock %} 